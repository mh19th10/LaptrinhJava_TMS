<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TMS - Dashboard (Há»c sinh)</title>
  <link rel="stylesheet" href="assets/css/global.css" />
  <link rel="stylesheet" href="assets/css/dashboard.css" />
</head>
<body>
  <div class="app-container" id="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">T</div>
        <div>
          <h3>TMS</h3>
          <div class="small-muted">Há»c sinh</div>
        </div>
      </div>

      <nav class="nav">
        <a href="dashboard_student.html" class="active">ğŸ  Trang chá»§</a>
        <a href="classes_student.html">ğŸ“š Lá»›p há»c</a>
        <a href="tuition_student.html">ğŸ’° Há»c phÃ­</a>
        <a href="profile_student.html">ğŸ‘¤ Há»“ sÆ¡</a>
        <a href="#" id="logoutBtn">ğŸšª ÄÄƒng xuáº¥t</a>
      </nav>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <div class="header-row">
        <div>
          <div class="h1" id="studentName">Äang táº£i...</div>
          <div class="small-muted">ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i há»‡ thá»‘ng TMS</div>
        </div>
      </div>

      <div class="cards" id="studentStats"><!-- Dá»¯ liá»‡u thá»‘ng kÃª sáº½ Ä‘Æ°á»£c render á»Ÿ Ä‘Ã¢y --></div>

      <div class="card">
        <div class="h2">Lá»›p há»c sáº¯p diá»…n ra</div>
        <table class="table" style="margin-top:12px">
          <thead>
            <tr><th>Lá»›p</th><th>GiÃ¡o viÃªn</th><th>Thá»i gian</th><th>HÃ nh Ä‘á»™ng</th></tr>
          </thead>
          <tbody id="upcomingClasses"><!-- Dá»¯ liá»‡u lá»›p há»c sáº½ Ä‘Æ°á»£c render á»Ÿ Ä‘Ã¢y --></tbody>
        </table>
      </div>
    </main>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {

      const token = localStorage.getItem('authToken');  // ğŸŸ¢ FIXED

      if (!token) {
          alert('Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ truy cáº­p trang nÃ y!');
          window.location.href = 'login.html';
          return;
      }

      fetch('/api/student/info', {
          method: 'GET',
          headers: {
              'Authorization': 'Bearer ' + token
          }
      })
      .then(res => {
          if (res.status === 401 || res.status === 403) {
              throw new Error("Token háº¿t háº¡n hoáº·c khÃ´ng há»£p lá»‡!");
          }
          return res.json();
      })
      .then(data => {
          document.getElementById('studentName').textContent =
              data.fullName || "Há»c sinh";
      })
      .catch(err => {
          alert("PhiÃªn Ä‘Äƒng nháº­p háº¿t háº¡n, vui lÃ²ng Ä‘Äƒng nháº­p láº¡i.");
          localStorage.clear();
          window.location.href = "login.html";
      });

  });
  </script>
  <script src="assets/js/tms-api.js"></script>



</body>
</html>
